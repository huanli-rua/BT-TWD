DATA:
  dataset_name: "diabetic"
  raw_path: "data/diabetes/diabetic_data.csv"
  target_col: "readmitted"
  positive_label: "<30"
  file_type: "csv"
  use_kfold: true
  n_splits: 5
  shuffle: true
  stratify: true
  random_state: 42

PREPROCESS:
  continuous_cols:
    - "time_in_hospital"
    - "num_lab_procedures"
    - "num_procedures"
    - "num_medications"
    - "number_outpatient"
    - "number_emergency"
    - "number_inpatient"
    - "number_diagnoses"

  categorical_cols:
    - "race"
    - "gender"
    - "age"
    - "admission_type_id"
    - "discharge_disposition_id"
    - "admission_source_id"
    - "payer_code"
    - "medical_specialty"
    - "max_glu_serum"
    - "A1Cresult"
    - "metformin"
    - "repaglinide"
    - "nateglinide"
    - "chlorpropamide"
    - "glimepiride"
    - "acetohexamide"
    - "glipizide"
    - "glyburide"
    - "tolbutamide"
    - "pioglitazone"
    - "rosiglitazone"
    - "acarbose"
    - "miglitol"
    - "troglitazone"
    - "tolazamide"
    - "examide"
    - "citoglipton"
    - "insulin"
    - "glyburide-metformin"
    - "glipizide-metformin"
    - "glimepiride-pioglitazone"
    - "metformin-rosiglitazone"
    - "metformin-pioglitazone"
    - "change"
    - "diabetesMed"

  drop_cols:
    - "encounter_id"
    - "patient_nbr"

  impute_strategy:
    continuous: "median"
    categorical: "most_frequent"
  scale_continuous: true
  scaler_type: "standard"
  encoding_type: "onehot"
  drop_first: true
  save_feature_names: true

SCORE:
  bucket_score_mode: "f1_regret_bnd"
  f1_weight: 1.0
  regret_weight: 1.0
  bnd_weight: 0.5

BTTWD:
  bucket_levels:
    - level: 1
      name: "L1_age"
      type: "category_group"
      col: "age"
      groups:
        - label: "age_le_40"
          values: ["[0-10)", "[10-20)", "[20-30)", "[30-40)"]
        - label: "age_40_60"
          values: ["[40-50)", "[50-60)"]
        - label: "age_60_80"
          values: ["[60-70)", "[70-80)"]
        - label: "age_ge_80"
          values: ["[80-90)", "[90-100)"]

    - level: 2
      name: "L2_admission_type"
      type: "category_group"
      col: "admission_type_id"
      groups:
        - label: "EmergentUrgent"
          values: [1, 2, 3]
        - label: "Elective"
          values: [4]
        - label: "Newborn"
          values: [5]
        - label: "OtherType"
          values: [6, 7, 8]

    - level: 3
      name: "L3_stay"
      type: "numeric_bin"
      col: "time_in_hospital"
      bins: [3, 7]
      labels: ["short_stay", "mid_stay", "long_stay"]

    - level: 4
      name: "L4_prev_inpatient"
      type: "numeric_bin"
      col: "number_inpatient"
      bins: [1, 3]
      labels: ["no_prev_inpt", "few_prev_inpt", "many_prev_inpt"]
  min_bucket_size: 300
  max_levels: 4
  use_gain: true
  min_gain_for_split: 0.0
  gamma_bucket: 0.0
  bucket_subsample: 0.7
  max_train_samples_per_bucket: 30000
  parent_share_rate: 0.2
  min_parent_share: 50
  val_ratio: 0.3
  min_val_samples_per_bucket: 100
  use_global_backoff: true
  global_estimator: "xgb"
  bucket_estimator: "none"
  posterior_estimator: "logreg"
  logreg_C: 1.0
  knn_k: 6
  bucket_rf:
    n_estimators: 200
    max_depth: null
    random_state: 42
    n_jobs: -1
  bucket_xgb:
    n_estimators: 200
    max_depth: 3
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    reg_lambda: 1.0
    random_state: 42
    n_jobs: -1
  global_xgb:
    n_estimators: 300
    max_depth: 4
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    reg_lambda: 1.0
    random_state: 42
    n_jobs: -1

THRESHOLD:
  mode: "bucket_wise"
  objective: "regret"
  alpha_grid: [0.3, 0.4, 0.5, 0.6, 0.7]
  beta_grid:  [0.0, 0.1, 0.2, 0.3, 0.4]
  gap_min: 0.1
  costs:
    C_TP: 0.0
    C_TN: 0.0
    C_FP: 1.0
    C_FN: 3.0
    C_BP: 2.0
    C_BN: 0.5
  min_samples_for_thresholds: 100

BASELINES:
  use_logreg: true
  use_random_forest: true
  use_knn: true
  use_xgboost: true

  common:
    threshold_mode: "fixed"
    fixed_threshold: 0.4
  logreg:
    C: 1.0
    max_iter: 500
    use_custom_threshold: true
    custom_threshold: 0.4
  random_forest:
    n_estimators: 200
    max_depth: null
    random_state: 42
    use_custom_threshold: true
    custom_threshold: 0.4

  knn:
    n_neighbors: 6
    use_custom_threshold: true
    custom_threshold: 0.4

  xgboost:
    n_estimators: 300
    max_depth: 4
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    reg_lambda: 1.0
    random_state: 42
    n_jobs: -1
    use_custom_threshold: true
    custom_threshold: 0.4

EXP:
  kfold_repeats: 1
  n_jobs: -1
  verbose: 1

METRICS:
  use_metrics: ["Precision", "Recall", "F1", "BAC", "AUC", "MCC", "Kappa", "Regret"]
  pos_label: 1

OUTPUT:
  results_dir: "results/diabetic_bttwd"
  figs_dir: "figs"
  save_per_fold_metrics: true
  save_bucket_metrics: true
  save_config_copy: true
  save_threshold_logs: true
  threshold_log_filename: "bucket_thresholds_per_fold.csv"

SEED:
  global_seed: 42
