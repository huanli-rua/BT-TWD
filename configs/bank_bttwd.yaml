DATA:
  dataset_name: "bank_full"              # 数据集名称（加载 bank_full 特殊分支）
  raw_path: "data/bank/bank-full.csv"    # 原始数据文件路径（分号分隔）
  data_path: "data/bank/bank-full.csv"   # 训练使用的数据文件路径
  target_col: "y"                         # 标签列名（"yes"/"no"）
  positive_label: "yes"                  # 原始正类取值，会在加载时映射为 1
  negative_label: "no"                   # 原始负类取值，会在加载时映射为 0
  file_type: "csv"                       # 文件类型，明确走 CSV 加载逻辑
  sep: ";"                               # 列分隔符（bank 数据为分号）
  use_kfold: true                         # 是否启用 K 折
  n_splits: 5                             # K 折数量
  shuffle: true                           # 拆分时是否打乱
  stratify: true                          # 拆分时是否分层抽样
  random_state: 42                        # 随机种子
  split:                                  # 显式划分比例，供 K 折/holdout 读取
    strategy: "random_stratified"         # 分层随机划分
    val_ratio: 0.3                        # 验证集占比（覆盖桶内阈值搜索的验证比例）
    test_ratio: 0.2                       # 测试集占比（K=5 -> 每折测试 20%）
    random_state: 42                      # 切分随机种子，与上方保持一致

PREPROCESS:
  continuous_cols:
    - "age"
    - "balance"
    - "day"
    - "duration"
    - "campaign"
    - "pdays"
    - "previous"
  categorical_cols:
    - "job"
    - "marital"
    - "education"
    - "default"
    - "housing"
    - "loan"
    - "contact"
    - "month"
    - "poutcome"
  handle_missing: "none"                 # 缺失值处理方式（bank 数据缺失较少，先不特殊处理）
  fillna_strategy: "most_frequent"       # 填充策略（如需要使用众数填充）
  scale_continuous: true                  # 是否对连续特征做标准化
  scaler_type: "standard"                # 连续特征标准化方式（standard/robust 等）
  encoding_type: "onehot"                # 类别特征编码方式
  drop_first: true                        # 是否丢弃第一列以避免共线性
  save_feature_names: true                # 是否保存特征名以便解释

SCORE:
  bucket_score_mode: "f1_regret_bnd"             # 桶得分基于 F1 - λ1 * Regret - λ2 * BND_ratio，用于弱桶判定和增益计算，不控制分桶结构
  f1_weight: 1.0                                  # F1 前的系数
  regret_weight: 1.0                              # Regret 的惩罚权重
  bnd_weight: 1.0                                 # BND_ratio 的惩罚权重

BTTWD:
  bucket_levels:
    - level: 1
      name: "L1_age"
      type: "numeric_bin"
      col: "age"
      bins: [30, 40, 50, 60]              # 年龄分桶边界
      labels: ["<=30", "30-40", "40-50", "50-60", ">60"]

    - level: 2
      name: "L2_job"
      type: "categorical_group"
      col: "job"
      groups:
        white_collar:  ["admin.", "management", "technician"]
        blue_collar:   ["blue-collar", "services", "housemaid"]
        self_emp:      ["self-employed", "entrepreneur"]
        no_income:     ["student", "unemployed"]
        retired:       ["retired"]
        unknown:       ["unknown"]
      default_group: "unknown"             # 不在上述分组内的类别归入 unknown

    - level: 3
      name: "L3_contact"
      type: "categorical_group"
      col: "contact"
      groups:
        cellular: ["cellular"]
        telephone: ["telephone"]
      default_group: "unknown"             # 未覆盖渠道归为 unknown

  min_bucket_size: 30                      # 叶子桶最少样本数，分裂停止条件之一（配合 max_levels 使用）；本配置不另设正样本数门槛
  use_min_bucket_size_limit: true           # 是否启用按最小样本数限制继续分桶
  use_merge_small_to_residual: true       # 是否将小于 min_bucket_size 的子桶合并到 residual/others（与最小样本限制解耦）
  max_levels: 3                            # 桶树最大层数，达到该层后不再继续细分
  use_gain: true                           # 预留参数，增益仅用于弱桶判定和阈值回退，不控制是否分裂
  min_gain_for_split: 0.0                # 桶增益阈值：增益小于该值的桶视为弱桶，阈值/决策优先回退到父桶或 ROOT
  use_gain_weak_backoff: true             # 是否启用基于增益判定的弱桶回退逻辑
  gamma_bucket: 0.00                       # 桶数复杂度惩罚系数
  bucket_subsample: 1.0                    # =1.0 表示不做桶内子采样，所有训练样本都参与桶内模型训练
  max_train_samples_per_bucket: 5000       # 每个桶最多用于训练的样本数
  use_parent_share_rate: true              # true：父桶按 share_rate 采样子桶；false：父桶使用全部子桶样本
  parent_share_rate: 0.3                  # 父桶按比例采样子桶贡献的样本占比
  min_parent_share: 30                    # 父桶最少回流样本数，低于该值则改用全部子桶样本
  val_ratio: 0.3                          # 只要桶内验证集样本数 >= min_val_samples_per_bucket，就会单独搜阈值，否则记为弱桶回退
  min_val_samples_per_bucket: 20          # 只要桶内验证集样本数 >= min_val_samples_per_bucket，就会单独搜阈值，否则记为弱桶回退
  use_global_backoff: true                # 桶/父桶无模型时是否回退全局模型
  global_estimator: "xgb"                 # 全局兜底模型：logreg/xgb/rf/knn/nb/none
  bucket_estimator: "none"                # 桶内局部模型：logreg/xgb/rf/knn/nb/none
  posterior_estimator: "logreg"           # 后验概率校准模型类型
  logreg_C: 1.0                           # 逻辑回归正则化强度
  knn_k: 10                               # KNN 邻居数
  bucket_rf:                              # 桶内随机森林参数
    n_estimators: 200
    max_depth: null
    random_state: 42
    n_jobs: -1
  bucket_xgb:                             # 桶内 XGBoost 参数（若启用）
    n_estimators: 200
    max_depth: 3
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    reg_lambda: 1.0
    random_state: 42
    n_jobs: -1
  global_xgb:                             # 全局 XGBoost 参数
    n_estimators: 300                     # 迭代树数
    max_depth: 4                          # 树深度
    learning_rate: 0.1                    # 学习率
    subsample: 0.8                        # 行采样比例
    colsample_bytree: 0.8                 # 列采样比例
    reg_lambda: 1.0                       # L2 正则项
    random_state: 42                      # 随机种子
    n_jobs: -1                            # 并行线程数

THRESHOLDS:
  thresholds_mode: "bucket_wise"           # 阈值模式，目前只支持 bucket_wise；字段名要和代码中的 thresholds_mode 对应
  objective: "regret"                     # 桶阈值搜索以 regret 为优化目标，F1/BND 仅记录用于分析，不参与分桶结构或分裂控制
  alpha_grid: [0.1,0.2,0.3,0.4,0.5,0.6, 0.7, 0.8, 0.9,1]         # α 候选，BAC、F1、AUC 等指标也会记录到 bucket_metrics_gain.csv 便于分析
  beta_grid: [0,0.1, 0.2, 0.3, 0.4,0.5,0.6, 0.7, 0.8, 0.9]          # β 候选
  gap_min: 0.1                            # α、β 间隔下限
  costs:
    C_TP: 0.0                              # 真正类成本
    C_TN: 0.0                              # 真负类成本
    C_FP: 0.75                              # 假正类成本（误报）
    C_FN: 2.0                             # 假负类成本（漏报）
    C_BP: 1.0                              # 边界-正成本
    C_BN: 0.25                              # 边界-负成本
  alpha_init: 0.7                         # α 搜索初始值
  beta_init: 0.2                          # β 搜索初始值
  min_samples_for_thresholds: 80          # 桶内验证样本 ≥ 80 才启用单桶阈值搜索，不足则直接回退父桶/ROOT 阈值

BASELINES:
  use_logreg: true                        # 是否训练逻辑回归 baseline
  use_random_forest: true                # 是否训练随机森林 baseline
  use_knn: true                          # 是否训练 KNN baseline
  use_xgboost: true                       # 是否训练 XGBoost baseline

  common:
    threshold_mode: "per_model"               # baseline 统一的阈值模式
    fixed_threshold: 0.4                  # 若使用固定阈值时的默认阈值
  logreg:
    C: 1.0                                # 逻辑回归正则化强度
    max_iter: 500                         # 逻辑回归最大迭代次数
    use_custom_threshold: true            # 是否为逻辑回归单独指定阈值
    custom_threshold: 0.4                 # 逻辑回归自定义阈值
  xgboost:
    n_estimators: 300                     # 迭代树数
    max_depth: 4                          # 树最大深度
    learning_rate: 0.1                    # 学习率
    subsample: 0.8                        # 行采样比例
    colsample_bytree: 0.8                 # 列采样比例
    reg_lambda: 1.0                       # L2 正则项
    random_state: 42                      # 随机种子
    n_jobs: -1                            # 并行线程数
    use_custom_threshold: true            # 是否为 XGBoost 指定独立阈值
    custom_threshold: 0.4                 # XGBoost 自定义阈值

EXP:
  kfold_repeats: 1                        # K 折重复次数
  n_jobs: -1                              # 并行线程数
  verbose: 1                              # 日志级别

METRICS:
  use_metrics: ["Precision", "Recall", "F1", "BAC", "AUC", "MCC", "Kappa", "Regret"]  # 需要计算的指标
  pos_label: 1                            # 正类标签取值

tSNE:
  sample_size: 2000      # 可视化使用的最大样本数，<=0 表示不截断
  perplexity: 30.0       # t-SNE 的 perplexity 参数
  learning_rate: 200.0   # t-SNE 的学习率
  random_state: 42       # 随机种子，控制采样和 t-SNE 复现性

OUTPUT:
  results_dir: "results/bank_bttwd"      # 结构 CSV 和回退统计 CSV 会一并写到这里
  figs_dir: "figs"                       # 图像保存目录
  save_per_fold_metrics: true             # 是否保存单折指标
  save_bucket_metrics: true               # 是否保存桶级指标
  save_config_copy: true                  # 是否保存配置副本
  save_threshold_logs: true               # 是否保存阈值搜索日志
  threshold_log_filename: "bucket_thresholds_per_fold.csv"  # 阈值日志文件名

SEED:
  global_seed: 42                         # 全局随机种子
